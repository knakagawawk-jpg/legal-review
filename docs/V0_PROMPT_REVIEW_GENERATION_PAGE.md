# v0 用プロンプト：講評生成ページのデザイン改善

## 概要

法律答案の自動講評システムの講評生成ページを v0 でデザイン改善します。
現在のページは Next.js + Tailwind CSS + shadcn/ui で実装されており、問題選択と答案入力を行うページです。

---

## 現在のページ構造

### レイアウト概要

```
┌─────────────────────────────────────────────────────────┐
│ 固定ヘッダーバー（z-30、半透明背景）                    │
│ Juristutor-AI                                           │
│ 過去問の答案をAIで講評します                             │
│ [試験種別▼] [年度▼] [科目▼] (既存問題モード時のみ右側) │
├─────────────────────────────────────────────────────────┤
│ メインコンテンツ（pt-32でヘッダー分の余白）              │
│ ┌─────────────────────────────────────────────────┐   │
│ │ [既存問題を選択] [新規入力]  ← モード切替ボタン   │   │
│ ├─────────────────────────────────────────────────┤   │
│ │                                                 │   │
│ │ [既存問題モードの場合]                        │   │
│ │ ┌─────────────────────────────────────────┐   │   │
│ │ │ 予備試験 平成30年 行政法                 │   │   │
│ │ │ ▼ 問題文を表示する      [コピー]        │   │   │
│ │ │ (アコーディオンで展開/折りたたみ)        │   │   │
│ │ │ ┌─────────────────────────────────┐   │   │   │
│ │ │ │ 問題文テキスト...                │   │   │   │
│ │ │ │ (15行固定360px、スクロール可能)  │   │   │   │
│ │ │ └─────────────────────────────────┘   │   │   │
│ │ │ [出題趣旨] (アコーディオン、任意)      │   │   │
│ │ └─────────────────────────────────────────┘   │   │
│ │                                                 │   │
│ │ [新規入力モードの場合]                          │   │
│ │ - 問題文入力欄（Textarea、min-h-[200px]）      │   │
│ │ - 出題趣旨入力欄（任意、Textarea、min-h-[100px]）│   │
│ │                                                 │   │
│ │ ─────────────────────────────────────────────  │   │
│ │ 答案                                            │   │
│ │ [答案] [○ 文字]  ← 文字数カウント             │   │
│ │ ┌─────────────────────────────────────────┐   │   │
│ │ │ 答案テキスト...                          │   │   │
│ │ │ (15行固定360px、スクロール可能)          │   │   │
│ │ │ モノスペースフォント、resize-none        │   │   │
│ │ └─────────────────────────────────────────┘   │   │
│ └─────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
                                         [講評開始] ← 右下固定（bottom-6 right-6）
```

### 主要な要素

1. **固定ヘッダーバー**

   - 位置: `fixed top-0 left-0 right-0 z-30`
   - 背景: `bg-background/95 backdrop-blur`
   - 左側: "Juristutor-AI" タイトル（text-2xl font-bold）と説明文（text-sm text-muted-foreground）
   - 右側: 選択ボックス（試験種別、年度、科目）- 既存問題モード時のみ表示
   - 選択ボックス: 小さめのサイズ（w-24, w-28, w-32）、ラベルは text-xs

2. **モード切替**

   - 2 つのボタン: "既存問題を選択" / "新規入力"
   - `flex-1`で等幅
   - アクティブなモードが`variant="default"`、非アクティブが`variant="outline"`

3. **既存問題モード**

   - ヘッダーに選択ボックス（試験種別、年度、科目）
   - 3 つすべて選択されていて、問題が 1 件のみの場合に自動表示
   - 問題文はアコーディオンで折りたたみ可能（初期状態は閉じている）
   - アコーディオンの横に「問題文を表示する」「非表示にする」の小さなテキスト（text-xs text-muted-foreground）
   - コピーボタン付き（Copy/Check アイコン）
   - 問題文表示エリア: 15 行固定高さ（max-h-[360px]）、スクロール可能、グレー背景（bg-muted/50）
   - 出題趣旨: ネストされたアコーディオン（任意）

4. **新規入力モード**

   - 問題文入力欄（Textarea、min-h-[200px]）
   - 出題趣旨入力欄（任意、Textarea、min-h-[100px]）

5. **答案入力欄**

   - 常に表示（モードや問題選択に関係なく）
   - 上部にボーダー（border-t pt-6）で区切り
   - ラベルと文字数カウントを横並び表示
   - 15 行固定高さ（h-[360px]）、スクロール可能（overflow-y-auto）
   - モノスペースフォント（font-mono text-sm）
   - リサイズ不可（resize-none）
   - localStorage に自動保存（`review_answer_text`キー）

6. **講評開始ボタン**
   - 画面右下に固定表示（`fixed bottom-6 right-6 z-30`）
   - 影付き（shadow-lg）
   - 大きめのサイズ（size="lg"）
   - 問題と答案が準備できていない場合は無効化
   - ローディング時はスピナーと「生成中...」を表示

---

## 現在のデザインの問題点

1. **視覚的な階層が不明確**

   - 問題選択部分と答案入力部分の区別が弱い
   - 重要な要素（問題文、答案）が目立たない
   - 単一カラムレイアウトで情報が縦に並びすぎている

2. **情報密度**

   - 一度に多くの情報が表示される
   - スクロール量が多い場合がある
   - 問題文と答案を同時に見比べにくい

3. **UI の一貫性**

   - 選択ボックスがヘッダーにあるが、視認性が低い可能性
   - モード切替が単純なボタンのみで、タブやセグメントコントロールの方が直感的かも
   - 問題表示カードのデザインがシンプルすぎる

4. **フィードバック**

   - 入力状態や準備状況の視覚的フィードバックが弱い
   - 文字数カウントは表示されているが、進捗バーなどがない
   - 講評開始ボタンの無効化理由が明確でない

5. **使いやすさ**
   - 問題文と答案を同時に見比べるのが難しい（単一カラム）
   - 答案入力欄が下の方にあるため、問題を確認しながら入力しにくい

---

## v0 に求める改善点

### デザイン改善の優先順位

#### 1. **レイアウトの最適化**（最重要）

- **左右 2 カラムレイアウトの検討**
  - 左側: 問題選択/表示エリア
  - 右側: 答案入力エリア
  - 問題文と答案を同時に見比べられるように
- または、上段に問題選択、下段に答案入力という明確な分割
- セクション間の視覚的分離を強化（背景色、ボーダー、影など）

#### 2. **問題選択部分の改善**

- 選択ボックスの視認性向上（ヘッダーから移動するか、より目立つデザインに）
- 選択された問題の表示をより目立たせる（カードデザインの強化、アイコン追加など）
- アコーディオンの開閉状態がわかりやすく（アイコン、色、アニメーション）
- コピーボタンの位置とスタイル改善
- 問題文表示エリアのデザイン改善（背景色、ボーダー、影など）

#### 3. **答案入力部分の改善**

- 入力欄の視認性向上（背景色、ボーダー、影など）
- 文字数カウントの表示を改善（進捗バーの追加、色分けなど）
- 入力のしやすさを向上（フォントサイズ、行間、パディング）
- 入力状態の視覚的フィードバック（フォーカス時のハイライトなど）

#### 4. **モード切替の改善**

- タブデザインやセグメントコントロールへの変更検討
- モード切替時のアニメーション
- 現在のモードが明確にわかるように（アイコン、色、バッジなど）

#### 5. **講評開始ボタンの改善**

- ボタンの位置とサイズの最適化
- 無効化時の状態をより明確に（理由の表示、ツールチップなど）
- ローディング状態の視覚化改善（プログレスバー、アニメーションなど）

#### 6. **レスポンシブ対応**

- モバイル表示時のレイアウト調整（2 カラム →1 カラム）
- タブレット表示の最適化
- 固定ヘッダーの高さ調整

---

## v0 へのプロンプト例

```
法律答案の自動講評システムの講評生成ページをデザインしてください。

【ページ構造】
- 固定ヘッダー（z-30、半透明背景 + ぼかし効果）
  - 左側: "Juristutor-AI" タイトル（text-2xl）と説明文
  - 右側: 選択ボックス（試験種別、年度、科目）- 既存問題モード時のみ表示
- メインコンテンツ（pt-32でヘッダー分の余白）:
  1. モード切替（既存問題を選択 / 新規入力）
     - タブまたはセグメントコントロール形式を推奨
     - アクティブなモードが明確にわかるように
  2. 問題選択/入力エリア
     - 既存問題モード:
       * ヘッダーの選択ボックスで選択
       * 問題が一意に定まったら自動表示（アコーディオン、初期は閉じている）
       * タイトル: "予備試験 平成30年 行政法"
       * トグル: 「問題文を表示する」「非表示にする」の小さなテキスト
       * コピーボタン
       * 問題文エリア: 15行固定（360px）、スクロール可能、グレー背景
       * 出題趣旨（任意、ネストされたアコーディオン）
     - 新規入力モード:
       * 問題文入力欄（Textarea）
       * 出題趣旨入力欄（任意、Textarea）
  3. 答案入力エリア（常に表示）
     - ラベル + 文字数カウント（進捗バー推奨）
     - 15行固定（360px）、スクロール可能、モノスペースフォント
     - 白背景、ボーダー付き
     - localStorageに自動保存
  4. 講評開始ボタン（右下固定、影付き、大きめ）

【レイアウト提案】
- オプションA: 左右2カラムレイアウト
  - 左側（40-50%）: 問題選択/表示エリア
  - 右側（50-60%）: 答案入力エリア
  - 問題文と答案を同時に見比べられる
- オプションB: 上下分割レイアウト
  - 上段: 問題選択/表示エリア
  - 下段: 答案入力エリア
  - より明確なセクション分け

【主要な表示要素】
1. 固定ヘッダー: 半透明背景 + ぼかし効果、タイトルと選択ボックスを横並び
2. モード切替: タブまたはセグメントコントロール、アクティブな方がハイライト
3. 問題表示（既存問題モード）:
   - カード形式、プライマリカラーのボーダー
   - アコーディオン形式（初期は閉じている）
   - タイトル: "予備試験 平成30年 行政法"
   - トグル: 「問題文を表示する」「非表示にする」の小さなテキスト
   - コピーボタン（Copy/Checkアイコン）
   - 問題文エリア: 15行固定（360px）、スクロール可能、グレー背景
4. 答案入力:
   - ラベル + 文字数カウント（進捗バー推奨）
   - 15行固定（360px）、スクロール可能、モノスペースフォント
   - 白背景、ボーダー付き、影付き
5. 講評開始ボタン: 右下固定、大きめのサイズ、影付き、無効化時はグレーアウト + 理由表示

【デザイン要件】
- モダンでクリーンなデザイン
- 問題選択部分と答案入力部分の視覚的分離（背景色、ボーダー、影など）
- 重要な要素（問題文、答案）が目立つように
- 読みやすさと使いやすさを重視
- 適度な余白とパディング
- スクロール可能なエリアは明確に
- 入力欄は使いやすいサイズとフォント
- カードデザインを活用して情報を整理

【技術要件】
- React/Next.js（App Router）
- TypeScript
- Tailwind CSSを使用
- shadcn/uiコンポーネント（Card, Button, Textarea, Accordion, Badge, Tabs等）
- レスポンシブ対応（モバイル: 1カラム、デスクトップ: 2カラム推奨）
- アニメーションは控えめに（トランジション、ホバー効果など）

【現在の実装の特徴（維持すべき機能）】
- 固定ヘッダーバー（z-30、半透明背景）
- 選択ボックスはヘッダーの右側に配置（既存問題モード時のみ）
- 問題文はアコーディオンで折りたたみ可能、初期状態は閉じている
- アコーディオンの横に「問題文を表示する」「非表示にする」の小さなテキスト
- 答案入力欄は常に表示され、問題選択に影響されない
- 文字数カウント表示
- localStorageで答案を自動保存（`review_answer_text`キー）
- 講評開始ボタンは画面右下に固定（bottom-6 right-6）
- 講評開始ボタンの無効化ロジック（問題と答案が準備できていない場合）
- 3つすべて選択されていて、問題が1件のみの場合に自動表示

【改善してほしい点】
1. レイアウトの最適化（2カラムや明確なセクション分けなど）
2. 問題選択部分と答案入力部分の視覚的分離
3. UIコンポーネントの視認性向上
4. モード切替をタブまたはセグメントコントロールに
5. 文字数カウントに進捗バーを追加
6. 講評開始ボタンの無効化理由を表示
7. 全体的なデザインのモダン化
8. カードデザインの強化（影、ボーダー、背景色など）
```

---

## カラーパレット提案

### メインカラー

- **プライマリ**: 既存の Tailwind 設定に従う（通常は紫系 #667eea）
- **アクセント**: 問題選択部分と答案入力部分で異なる背景色を使用可能

### 機能別カラー

- **問題選択カード**: プライマリカラー（ボーダー、バッジなど）
- **答案入力欄**: 白背景、ボーダー、軽い影
- **ボタン**: プライマリカラー（アクティブ時）
- **無効化状態**: グレー、理由表示
- **進捗バー**: プライマリカラーまたは緑系

---

## 参考になるデザインパターン

1. **フォームデザイン**: 段階的な入力と明確なセクション分け
2. **ダッシュボード UI**: 情報の階層化と視覚的分離
3. **教育プラットフォーム**: 問題選択と答案入力の UI（例: Codecademy、Khan Academy）
4. **モダンな Web アプリケーション**: クリーンで使いやすいインターフェース（例: Notion、Linear）
5. **コードエディタ**: 左右分割レイアウト（例: VSCode、GitHub Codespaces）

---

## 注意事項

- 既存の機能はすべて維持してください
  - ヘッダーの選択ボックス（既存問題モード時のみ表示）
  - アコーディオンの開閉機能
  - 「問題文を表示する」「非表示にする」のテキスト表示
  - 文字数カウント
  - localStorage への自動保存（`review_answer_text`キー）
  - 講評開始ボタンの無効化ロジック
  - 3 つすべて選択されていて、問題が 1 件のみの場合に自動表示
- shadcn/ui コンポーネントを使用してください
- レスポンシブデザインを考慮してください（モバイル: 1 カラム、デスクトップ: 2 カラム推奨）
- アクセシビリティを考慮してください
- TypeScript の型定義を維持してください

---

## 実装の詳細仕様

### 状態管理

- `mode`: "existing" | "new" - モード切替
- `examType`, `year`, `subject`: 選択ボックスの値
- `selectedMetadata`, `selectedDetails`: 選択された問題のデータ
- `questionText`, `purposeText`: 問題文と出題趣旨
- `answerText`: 答案テキスト（localStorage に自動保存）
- `accordionValue`: アコーディオンの開閉状態
- `loading`: 講評生成中の状態
- `error`: エラーメッセージ

### API 呼び出し

- `/api/problems/subjects` - 科目一覧取得
- `/api/problems/years` - 年度一覧取得
- `/api/problems/metadata` - 問題メタデータ取得（クエリパラメータ: exam_type, year, subject）
- `/api/problems/metadata/[id]` - 問題詳細取得
- `/api/review` - 講評生成（POST）

### バリデーション

- 答案が空の場合はエラー表示
- 問題と答案が準備できていない場合は講評開始ボタンを無効化
- 答案は最低 100 文字推奨（`canProceedToStep2`関数でチェック）
