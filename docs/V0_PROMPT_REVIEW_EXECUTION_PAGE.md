# v0用プロンプト：講評実行（生成）ページのデザイン改善

## 概要

法律答案の自動講評システムの講評実行（生成）ページをv0でデザイン改善します。
現在のページはStreamlitで実装されており、問題選択と答案入力を行い、LLMによる講評を生成します。

---

## 現在のページ構造

### レイアウト概要

```
┌─────────────────────────────────────────────────────────┐
│ ヘッダー: 📝 答案講評生成                                │
│ キャプション: LLMを使用して法律答案の自動講評を生成します │
├─────────────────────────────────────────────────────────┤
│ [ラジオボタン] 問題文の入力方法                          │
│ ○ 既存問題を選択  ○ 新規入力                             │
├─────────────────────────────────────────────────────────┤
│ 【既存問題を選択モード】                                 │
│ ┌─────────┬─────────┬─────────┐                       │
│ │試験種別  │ 年度     │ 科目    │                       │
│ │[選択]    │ [選択]   │ [選択]  │                       │
│ └─────────┴─────────┴─────────┘                       │
│                                                          │
│ [フィルターが完全に選択されると自動的に問題文を表示]     │
│                                                          │
│ ┌──────────────────────────────────────────────────┐  │
│ │ 📄 問題文                                         │  │
│ │ [問題文のテキストエリア（読み取り専用、高さ300）] │  │
│ └──────────────────────────────────────────────────┘  │
│                                                          │
│ [設問が複数ある場合は選択ボックスを表示]                │
│                                                          │
│ ┌──────────────────────────────────────────────────┐  │
│ │ 🎯 出題趣旨                                       │  │
│ │ [出題趣旨のテキストエリア（読み取り専用、高さ150）] │  │
│ └──────────────────────────────────────────────────┘  │
│                                                          │
│ 【新規入力モード】                                       │
│ 科目: [選択ボックス]                                    │
│ 問題文（任意）: [テキストエリア（高さ180）]             │
├─────────────────────────────────────────────────────────┤
│ 答案（必須）: [テキストエリア（高さ320）]               │
├─────────────────────────────────────────────────────────┤
│ [講評を生成] ボタン（プライマリ）                       │
└─────────────────────────────────────────────────────────┘
```

### 主要な要素

1. **ヘッダー**
   - タイトル: "📝 答案講評生成"
   - キャプション: "LLMを使用して法律答案の自動講評を生成します"

2. **入力モード選択**
   - ラジオボタン（横並び）: "既存問題を選択" / "新規入力"

3. **既存問題を選択モード**
   - **フィルター（3カラム）**:
     - 試験種別: 空文字列、司法試験、予備試験
     - 年度: APIから取得（例: R7, H30, H31...）
     - 科目: 固定リスト（憲法、行政法、民法...）
   - **問題文の自動表示**:
     - フィルターで一意に定まる場合、自動的に問題文を表示
     - グラデーションカード（紫系）で問題文を表示
     - 読み取り専用テキストエリア（高さ300px）
   - **設問選択**（設問が複数ある場合）:
     - セレクトボックスで設問を選択（デフォルト: 最初の設問）
   - **出題趣旨**（存在する場合）:
     - グラデーションカード（青系）で出題趣旨を表示
     - 読み取り専用テキストエリア（高さ150px）

4. **新規入力モード**
   - 科目選択: 固定リスト（空文字列含む）
   - 問題文（任意）: テキストエリア（高さ180px）

5. **答案入力**
   - 必須フィールド
   - テキストエリア（高さ320px）
   - プレースホルダー: "答案を貼り付け"

6. **生成ボタン**
   - "講評を生成" ボタン（プライマリ）
   - クリック後、ローディング表示 → 結果ページに遷移

---

## 現在のデザインの問題点

1. **フィルターの視認性が低い**
   - 3つのセレクトボックスが横並びで、どのフィルターが必要かわかりにくい
   - フィルターが不完全な場合のフィードバックが弱い
   - 段階的な選択（試験種別 → 年度 → 科目）の流れが明確でない

2. **入力モードの切り替えが不明確**
   - ラジオボタンが小さく、モードの違いが視覚的に弱い
   - モード切り替え時のフィードバックが弱い

3. **問題文表示が単調**
   - 長いテキストが読み取り専用テキストエリアに表示され、読みづらい
   - スクロールバーが目立たない
   - 出題趣旨との区別が視覚的に弱い

4. **答案入力エリアの機能不足**
   - 文字数カウンターがない
   - 入力内容の保存機能がない（リロード時に消失）
   - プレースホルダーがシンプルすぎる

5. **全体の流れが不明確**
   - ステップバイステップのガイダンスがない
   - どこまで完了したかがわかりにくい
   - 次のアクションが明確でない

6. **ローディング状態の表示がシンプル**
   - スピナーのみで、処理中のステップがわからない
   - 待ち時間の目安がない

---

## v0に求める改善点

### デザイン改善の優先順位

#### 1. **ステップバイステップのUI**（最重要）
- 3つのステップを明確に表示
  - Step 1: 問題選択 / 新規入力
  - Step 2: 答案入力
  - Step 3: 講評生成
- 各ステップの完了状態を視覚的に表示（チェックマーク、進捗バー）
- 現在のステップをハイライト表示

#### 2. **フィルターの改善**
- カード形式でフィルターを表示
- 段階的な選択の流れを視覚化（矢印やフロー図）
- フィルターが不完全な場合の警告を明確に
- 選択済みのフィルターをバッジ形式で表示

#### 3. **入力モードの切り替えを明確に**
- タブまたは大きなカードボタンでモードを切り替え
- 選択されたモードを視覚的に強調
- モード切り替え時のアニメーション（トランジション）

#### 4. **問題文表示の改善**
- 読みやすいフォントサイズと行間
- ハイライトや強調表示の追加
- コピーボタンの追加
- 出題趣旨を折りたたみ可能なアコーディオンで表示

#### 5. **答案入力エリアの強化**
- 文字数カウンター（リアルタイム更新）
- 入力内容の自動保存（session_stateを使用）
- より詳細なプレースホルダー（例: "答案をここに貼り付けてください。推奨文字数: 2,000-5,000文字"）
- 入力支援機能（テンプレートボタンなど）

#### 6. **生成ボタンとローディング状態の改善**
- 大きな目立つボタン
- ボタンの無効化状態の明確な表示（未入力時など）
- ローディング時の詳細なステップ表示（例: "問題文を解析中..." → "答案を評価中..." → "講評を生成中..."）
- プログレスバーの追加

#### 7. **レスポンシブ対応**
- モバイル表示時の縦積みレイアウト
- フィルターの配置調整
- テキストエリアのサイズ調整

---

## v0へのプロンプト例

```
法律答案の自動講評システムの講評実行（生成）ページをデザインしてください。

【ページ構造】
1. ヘッダー: タイトルとキャプション
2. ステップインジケーター（3ステップ）:
   - Step 1: 問題選択/新規入力
   - Step 2: 答案入力
   - Step 3: 講評生成
3. Step 1セクション:
   - タブまたはカードボタンでモード選択: "既存問題を選択" / "新規入力"
   - 【既存問題を選択】:
     - フィルターカード: 試験種別、年度、科目を段階的に選択（カード形式、矢印で接続）
     - 選択済みフィルターをバッジ表示
     - 問題文表示エリア（読みやすいフォント、コピーボタン付き）
     - 出題趣旨（アコーディオンで折りたたみ可能）
   - 【新規入力】:
     - 科目選択（セレクトボックス）
     - 問題文入力（任意、テキストエリア）
4. Step 2セクション:
   - 答案入力エリア（大きなテキストエリア）
   - 文字数カウンター（リアルタイム更新）
   - 入力支援機能（テンプレートボタンなど）
5. Step 3セクション:
   - 大きな「講評を生成」ボタン（プライマリカラー）
   - 未完了時の無効化表示
   - ローディング時の詳細ステップ表示（プログレスバー付き）

【デザイン要件】
- モダンでクリーンなデザイン
- ステップの完了状態を視覚的に明確に（チェックマーク、進捗バー）
- 現在のステップをハイライト表示
- フィルターの段階的な選択の流れを視覚化
- 入力エリアは使いやすく、視認性が高い
- 重要なアクション（生成ボタン）が目立つ
- エラーや警告を明確に表示
- React/Next.js、Tailwind CSS使用
- レスポンシブ対応

【カラーパレット】
- プライマリ: #667eea (紫系)
- セカンダリ: #764ba2 (濃い紫)
- 成功: #10b981 (緑)
- 警告: #f59e0b (黄)
- エラー: #ef4444 (赤)
- 背景: #fafafa (薄いグレー)
```

---

## データ構造

### フィルターの選択肢

**試験種別**:
- 空文字列（未選択）
- "司法試験"
- "予備試験"

**年度**:
- 空文字列（未選択）
- APIから動的に取得（例: "R7", "H30", "H31", "H32"...）
- 形式: "R7"（令和7年）、"H30"（平成30年）など

**科目**:
- 空文字列（未選択）
- 固定リスト:
  - 憲法
  - 行政法
  - 民法
  - 商法
  - 民事訴訟法
  - 刑法
  - 刑事訴訟法
  - 実務基礎（民事）
  - 実務基礎（刑事）
  - 倒産法
  - 租税法
  - 経済法
  - 知的財産法
  - 労働法
  - 環境法
  - 国際関係法（公法系）
  - 国際関係法（私法系）
  - 一般教養科目

### APIレスポンス構造

**問題取得（既存問題選択時）**:
```json
{
  "id": 123,
  "exam_type": "予備試験",
  "year": "H30",
  "subject": "民法",
  "question_text": "問題文のテキスト...",
  "purpose": "出題趣旨のテキスト..."
}
```

**講評生成リクエスト**:
```json
{
  "problem_id": 123,  // 既存構造用（後方互換性）
  "problem_metadata_id": 456,  // 新しい構造用
  "problem_details_id": 789,  // 新しい構造用（設問指定）
  "subject": "民法",
  "question_text": "問題文のテキスト...",  // 任意
  "answer_text": "答案のテキスト..."  // 必須
}
```

**講評生成レスポンス**:
```json
{
  "submission_id": 999,
  "status": "success"
}
```

---

## カラーパレット提案

### メインカラー
- **プライマリ**: `#667eea` (紫系)
- **セカンダリ**: `#764ba2` (濃い紫)

### 機能別カラー
- **成功/完了**: `#10b981` (緑)
- **警告**: `#f59e0b` (黄)
- **エラー**: `#ef4444` (赤)
- **情報**: `#3b82f6` (青)
- **背景**: `#fafafa` (薄いグレー)
- **テキスト**: `#1f2937` (濃いグレー)
- **ボーダー**: `#e5e7eb` (グレー)

---

## 参考になるデザインパターン

1. **マルチステップフォーム**: ステップバイステップの進行表示
2. **ダッシュボードUI**: フィルターとカードの組み合わせ
3. **入力フォーム**: リアルタイムバリデーションとフィードバック
4. **ローディングUI**: プログレスバーと詳細ステップ表示

---

## 注意事項

- 現在の実装はStreamlitのため、v0で生成されたReact/Next.jsコンポーネントをStreamlitに移植する必要があります
- Streamlitの制約（カスタムCSS/JSの注入、state管理）を考慮してデザインを提案してください
- 既存の機能（フィルター、問題選択、答案入力、生成ボタン）は維持してください
- session_stateを使用した入力内容の保持が必要です
